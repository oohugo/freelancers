
<h4><%= @project.title %></h4>
<dl>
		<dt>Descrição: </dt>
		<dd><%= @project.description %></dd>
		<dt>Máximo por hora: </dt>
		<dd><%= number_to_currency(@project.max_per_hour) %></dd>
		<dt>Data limite:</dt>
		<dd><%= @project.deadline %></dd>
		<dt>Atuação: </dt>
		<dd><%= @project.place == 'remote' ? 'Remoto' : 'Presencial' %></dd>
		<% if worker_signed_in? %>
				<dt>Avaliação do Empregador:</dt>
				<dd><%= @project.employer.rating.nil? ? 'Ainda não avaliado' : @project.employer.rating %></dd>
		<% end %>
</dl>

<% if worker_signed_in? %>
		<%= link_to @project.employer.email, @project.employer %>
		<% if @project.finished? %>
				<%= link_to 'Dar feedback ao Empregador e ao projeto', feedback_project_path %>
		<% else %>
				<% if @worker_proposal.empty? || @worker_proposal.take.canceled? %>
						<% if !@project.suspend? %>
								<%= form_with model: [@project, @proposal] do |form| %>
										<%= form.label :description %>
										<%= form.text_field :description %>
										<%= form.label :hourly_value %>
										<%= form.number_field :hourly_value %>
										<%= form.label :hours_per_week %>
										<%= form.number_field :hours_per_week %>
										<%= form.label :date_close %>
										<%= form.date_field :date_close %>
										<%= form.submit 'Enviar' %>
								<% end %>
						<% end %>
				<% else %>
						<% proposal =  @worker_proposal.take %>
						<dl>
								<dt>Comentário: </dt>
								<dd><%= proposal.description %></dd>
								<dt>Valor por hora:</dt>
								<dd><%= number_to_currency(proposal.hourly_value) %></dd>
								<dt>Horas disponíveis por semana:</dt>
								<dd><%= proposal.hours_per_week %></dd>
								<dt>Previsão de conclusão:</dt>
								<dd><%= proposal.date_close %></dd>
								<dt>Status: </dt>
								<dd><%= proposal.status %></dd>
						</dl>
						<% if proposal.accepted? && proposal.date_accepted < 3.days.ago  %>
								<%= form_with url:"/proposals/#{proposal.id}/cancel_with_justification", method: :post do |form| %>
										<p>
										<%= form.label :comment, 'Justifique o cancelamento' %>
										<%= form.text_field :comment %>
										</p>
										<%= form.submit 'Cancelar a proposta' %>
								<% end %>
						<% else %>
								<p><%= link_to 'Cancelar a proposta', cancel_proposal_path(proposal), method: :post %></p>
						<% end %>
				<% end %>
		<% end %>
<% end %>

<% if employer_signed_in? %>
		<ul>
				<li><%= link_to 'Suspender propostas', suspend_project_path(@project), method: :post %></li>
				<li><%= link_to 'Finalizar projeto', finished_project_path(@project), method: :post %></li>
				<li><%= link_to 'Dar feedback aos freelancers', feedback_project_path %></li>
		</ul>
		<% if @employer_proposals.empty? %>
				<p>Ainda não há propostas</p>
		<% else %>
				<% @employer_proposals.each do |proposal| %>
						<dl>
								<dt>Comentário: </dt>
								<dd><%= proposal.description %></dd>
								<dt>Valor por hora:</dt>
								<dd><%= number_to_currency(proposal.hourly_value) %></dd>
								<dt>Horas disponíveis por semana:</dt>
								<dd><%= proposal.hours_per_week %></dd>
								<dt>Previsão de conclusão:</dt>
								<dd><%= proposal.date_close %></dd>
								<dt>Status: </dt>
								<dd><%= proposal.status %></dd>
								<%= link_to proposal.worker.perfil_worker do %>
										<dt>Perfil do freelancer: </dt>
										<dd><%= proposal.worker.email %></dd>
								<% end %>
						</dl>
						<%= link_to 'Aceitar proposta', accepted_proposal_path(proposal), method: :post %>
						<%= link_to 'Rejeitar proposta', rejected_proposal_path(proposal), method: :post %>
				<% end %>
		<% end %>
<% end %>

<%= link_to('Pagina inicial', root_path) %>
